## API Платформы торговой сети электроники

**Backend-часть веб-приложения для торговой сети электроники.**

- Управление поставщиками товаров
- Управление товарами
- Управление контактными данными поставщиков

### Стек технологий:

- `Python`
- `Django`
- `DRF`
- `PostgreSQL`
- `Docker`
- `Redis`

## Содержание

<details>
<summary>Инструкция по локальному развертыванию проекта</summary>

#### 1. Скопируйте проект любым удобным способом.

#### 2. Установите зависимости из файла requirements.txt

#### 3. Создайте базу данных

#### 4. Настройте переменные окружения:

1. Создайте файл `.env` в корневой директории
2. Скопируйте в него содержимое файла `.env_example` и подставьте свои значения
3. Для запуска нужно или включить сервер `Redis`, или выключить использование кеша.

#### 5. Примените миграции

```
python manage.py migrate
```

#### 6. Запустите сервер

```
python manage.py runserver
```

</details>

<details>
<summary>Инструкция по развертыванию проекта с использованием Docker</summary>

#### 1. Скопируйте проект любым удобным способом.

#### 2. Настройте переменные окружения:

1. Создайте файл `.env` в корневой директории
2. Скопируйте в него содержимое файла `.env_example` и подставьте свои значения

#### 3. Запустите команду, для сборки контейнеров в docker-compose

```
docker-compose up -d --build
```

Чтобы попасть в контейнер с приложением и выполнять в нем команды, введите

```
docker exec -it <'id_контейнера' или имя 'app'> bash
```

</details>

<details>
<summary>Использование</summary>

#### 1. Административная панель:

Для доступа к админке создайте суперпользователя

1. Для создания суперпользователя (админа) выполните команду
    ```
    python manage.py csu
    ```
   E-mail и пароль суперпользоветеля для входа в админку вы можете посмотреть в
   файле `/users/management/commands/csu.py`. При желании, вы можете задать свои e-mail и пароль

2. Откройте административную панель по адресу http://localhost:8000/admin/ и введите e-mail и пароль суперпользователя

#### 2. Фикстуры:

В корне проекта есть файл data.json, который можно использовать для наполнения базы данных

```
python manage.py loaddata data.json
```

#### 3. Принцип работы:

- Авторизация пользователей происходит через JWT-токен, который можно получить по адресу http://127.0.0.1:8000/login/

- Поставщики, товары и контакты формируются по CRUD через запросы к серверу или через админку.

- Доступ к функционалу доступен только авторизованным пользователям, которые являются администраторами, т.е. у них
  должны быть установлены флаги `is_active` и `is_staff` в значение `true`.

- В админке Django для модели "Поставщик" добавлен admin_action, который позволяет обнулить задолженности у выбранных
  объектов.

- Есть возможность отфильтровать поставщиков по стране. Для этого нужно отправить `GET`-запрос в виде

    http://127.0.0.1:8000/retail/?country=<страна>

- Заблокирована возможность обновить задолженность у поставщика через `PATCH` или `PUT` запрос.

</details>

## Документация

Документация по API доступна по адресам:

- Swagger - http://127.0.0.1:8000/swagger/
- Redoc - http://127.0.0.1:8000/redoc/
